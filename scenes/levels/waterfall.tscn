[gd_scene load_steps=16 format=3 uid="uid://d4cka55p8sgn2"]

[ext_resource type="PackedScene" uid="uid://qik6lcaqekwf" path="res://scenes/managers/viewport_manager.tscn" id="1_iimn0"]
[ext_resource type="Script" uid="uid://bwe2vxf3k3ib0" path="res://scripts/GameManager.gd" id="2_r3bwv"]
[ext_resource type="PackedScene" uid="uid://cyw7cdjci5gg2" path="res://scenes/components/fade_out.tscn" id="3_0crih"]
[ext_resource type="PackedScene" uid="uid://dpwb7y1v2j0ss" path="res://scenes/components/fade_in.tscn" id="4_iqxcs"]
[ext_resource type="Script" uid="uid://cldm2bo1qftlf" path="res://scripts/TileManager.gd" id="5_08fey"]
[ext_resource type="PackedScene" uid="uid://caun6mhxmr543" path="res://scenes/tiles/tile.tscn" id="7_jsijq"]
[ext_resource type="Script" uid="uid://uxltb4grdhg5" path="res://scenes/levels/waterfall_manager.gd" id="8_fwk0t"]
[ext_resource type="ArrayMesh" uid="uid://c0q4k2k2ea4nu" path="res://art_assets/waterfall/Bottom_Water_3.obj" id="8_iimn0"]
[ext_resource type="Shader" uid="uid://cheo1scjtllak" path="res://scenes/levels/waterfall.gdshader" id="8_iqxcs"]
[ext_resource type="PackedScene" uid="uid://8rycyialk58q" path="res://scenes/components/player.tscn" id="8_tk7bx"]
[ext_resource type="Texture2D" uid="uid://b4h2d7jfrl7eu" path="res://art_assets/waterfall/Water_Texture_Refined.png" id="9_08fey"]
[ext_resource type="Script" uid="uid://c3oftxqubawdr" path="res://scenes/levels/water_movement.gd" id="10_0crih"]
[ext_resource type="ArrayMesh" uid="uid://ogdss2tn0qlr" path="res://art_assets/waterfall/Top_Water_3.obj" id="12_08fey"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_08fey"]
render_priority = 0
shader = ExtResource("8_iqxcs")
shader_parameter/cutoff = 0.0
shader_parameter/reverse = true
shader_parameter/height_min = 7.7
shader_parameter/height_max = 14.0
shader_parameter/waterfall_texture = ExtResource("9_08fey")
shader_parameter/uv_scale = Vector2(1, 1)
shader_parameter/uv_offset = Vector2(0, 0)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_iqxcs"]
render_priority = 0
shader = ExtResource("8_iqxcs")
shader_parameter/cutoff = 0.0
shader_parameter/reverse = true
shader_parameter/height_min = 2.0
shader_parameter/height_max = 7.0
shader_parameter/waterfall_texture = ExtResource("9_08fey")
shader_parameter/uv_scale = Vector2(1, 1)
shader_parameter/uv_offset = Vector2(0, 0)

[node name="GravityLevel" type="Node"]

[node name="ViewportManager" parent="." instance=ExtResource("1_iimn0")]

[node name="GameManager" type="Node" parent="." node_paths=PackedStringArray("endTile")]
script = ExtResource("2_r3bwv")
endTile = NodePath("TileManager/Tile5")

[node name="FadeOut" parent="GameManager" instance=ExtResource("3_0crih")]
visible = false
mouse_behavior_recursive = 1
next_scene_path = "res://scenes/levels/cutscene_1.tscn"

[node name="FadeIn" parent="GameManager" instance=ExtResource("4_iqxcs")]
visible = false
mouse_filter = 1
mouse_behavior_recursive = 1

[node name="Player" parent="GameManager" node_paths=PackedStringArray("current") instance=ExtResource("8_tk7bx")]
transform = Transform3D(0.9999925, -0.0038746211, 0, 0.0038746211, 0.9999925, 0, 0, 0, 1, 0, 1.5, 0)
current = NodePath("../TileManager/Tile")

[node name="TileManager" type="Node" parent="GameManager"]
script = ExtResource("5_08fey")

[node name="Tile" parent="GameManager/TileManager" node_paths=PackedStringArray("neighbors") instance=ExtResource("7_jsijq")]
neighbors = [NodePath("../Tile2")]

[node name="Tile2" parent="GameManager/TileManager" node_paths=PackedStringArray("neighbors") instance=ExtResource("7_jsijq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0)
neighbors = [NodePath("../Tile"), NodePath("../Tile3")]

[node name="Tile3" parent="GameManager/TileManager" node_paths=PackedStringArray("neighbors") instance=ExtResource("7_jsijq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, 0)
neighbors = [NodePath("../Tile2"), NodePath("../Tile4")]

[node name="Tile4" parent="GameManager/TileManager" node_paths=PackedStringArray("neighbors") instance=ExtResource("7_jsijq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 0, 0)
neighbors = [NodePath("../Tile3"), NodePath("../Tile5")]

[node name="Tile5" parent="GameManager/TileManager" node_paths=PackedStringArray("neighbors") instance=ExtResource("7_jsijq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, 0)
neighbors = [NodePath("../Tile4")]

[node name="WaterfallManager" type="Node" parent="." node_paths=PackedStringArray("topWaterfall", "bottomWaterfall")]
script = ExtResource("8_fwk0t")
topWaterfall = NodePath("TopWater")
bottomWaterfall = NodePath("BottomWater")

[node name="TopWater" type="MeshInstance3D" parent="WaterfallManager"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.45, -7.4, -6.4)
material_override = SubResource("ShaderMaterial_08fey")
mesh = ExtResource("12_08fey")
skeleton = NodePath("../..")
script = ExtResource("10_0crih")
height_min = 7.7
height_max = 14.0

[node name="BottomWater" type="MeshInstance3D" parent="WaterfallManager"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.4, -6.4, -6.4)
material_override = SubResource("ShaderMaterial_iqxcs")
mesh = ExtResource("8_iimn0")
skeleton = NodePath("../..")
script = ExtResource("10_0crih")
height_min = 2.0
height_max = 7.0
